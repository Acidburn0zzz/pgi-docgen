<html>
<head>

<script>

var main_page = "main.html";

function onLoad() {
    // takes the hash at the start and loads the path into the content frame

    var hash = window.location.hash;
    var elm = document.getElementById('Content');

    if(hash) {
        elm.src = hash.substring(1);
    } else {
        elm.src = main_page;
    }
}


function getHashForLocation(elm) {
    // get a hash for a location object, either a window location or a <a/>
    var this_path = window.location.pathname;
    var last_slash = this_path.lastIndexOf("/");
    var path = elm.pathname + elm.hash;
    return "#" + path.slice(last_slash + 1, path.length);
}


function setTopHash(hash) {
    var main_hash = "#" + main_page;
    if(hash == main_hash) {
        // 'space' clears it somehow..
        hash = " ";
    }

    if(history.pushState) {
        window.history.replaceState(null, window.document.title, hash);
    } else {
        window.location.hash = hash;
    }
}

function frameOnLoad() {
    // if the location of the frame changes, push hash to the frameset

    function onContentHashChange() {
        var elm = document.getElementById('Content');
        // don't set top hash on the first call
        if(elm.contentWindow.location.href != "about:blank") {
            setTopHash(getHashForLocation(elm.contentWindow.location));
        }
    }

    onContentHashChange();
    var elm = document.getElementById('Content');
    elm.contentWindow.onhashchange = function () {
        onContentHashChange();
    }
}

</script>

</head>
<frameset cols="300px,*" frameborder="1" bordercolor="#E2E2E2" BORDER="5" onload="onLoad();">
  <frame src="sidebar.html">
  <frame id="Content" name="Content" onload="frameOnLoad();">
</frameset>
</html>
